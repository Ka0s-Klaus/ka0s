apiVersion: v1
kind: ConfigMap
metadata:
  name: wazuh-agent-conf
  namespace: soc
data:
  ossec.conf: |
    <ossec_config>
      <client>
        <server>
          <address>wazuh-manager.soc.svc</address>
          <port>1514</port>
          <protocol>tcp</protocol>
        </server>
        <config-profile>ubuntu, debian, redhat, centos</config-profile>
      </client>
      
      <!-- Log Analysis from Host -->
      <localfile>
        <log_format>syslog</log_format>
        <location>/host/var/log/syslog</location>
      </localfile>
      <localfile>
        <log_format>syslog</log_format>
        <location>/host/var/log/auth.log</location>
      </localfile>
      <localfile>
        <log_format>syslog</log_format>
        <location>/host/var/log/dpkg.log</location>
      </localfile>
      <localfile>
        <log_format>syslog</log_format>
        <location>/host/var/log/kern.log</location>
      </localfile>

      <!-- Suricata Integration -->
      <localfile>
        <log_format>json</log_format>
        <location>/var/log/suricata/eve.json</location>
      </localfile>
    </ossec_config>
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: suricata-conf
  namespace: soc
data:
  suricata.yaml: |
    %YAML 1.1
    ---
    stats:
      enabled: yes
    outputs:
      - fast:
          enabled: no
      - eve-log:
          enabled: yes
          filetype: regular
          filename: eve.json
          types:
            - alert:
                payload: yes
                payload-buffer-size: 4kb
                payload-printable: yes
                packet: yes
                http: yes
                tls: yes
                ssh: yes
                smtp: yes
    
    af-packet:
      - interface: eth0
        cluster-id: 99
        cluster-type: cluster_flow
        defrag: yes
    
    app-layer:
      protocols:
        tls:
          enabled: yes
          detection-ports:
            81: 443
            82: 81
    
    detect:
      profile: medium
    
    default-rule-path: /var/lib/suricata/rules
    rule-files:
      - suricata.rules
