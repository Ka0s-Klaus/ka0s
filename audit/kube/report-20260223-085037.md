# Kubernetes Security Audit Report
Date: Mon Feb 23 08:50:37 UTC 2026

## 1. Privileged Containers
Pods running with 'privileged: true' (Full host access):
```
calico-system/calico-node-2cvj7
calico-system/calico-node-jd4cl
calico-system/calico-node-pjgs8
calico-system/calico-node-zgvjv
calico-system/csi-node-driver-8hf6g
calico-system/csi-node-driver-8hf6g
calico-system/csi-node-driver-dbm9t
calico-system/csi-node-driver-dbm9t
calico-system/csi-node-driver-kwltm
calico-system/csi-node-driver-kwltm
calico-system/csi-node-driver-q6fsx
calico-system/csi-node-driver-q6fsx
kube-system/kube-proxy-kblfg
kube-system/kube-proxy-p9gdf
kube-system/kube-proxy-t4sv5
kube-system/kube-proxy-zwsjt
```

## 2. Containers Running as Root
Pods not enforcing 'runAsNonRoot: true':
```
actions-runner-system/gha-rs-controller-cd9ccc9c5-2bn9d
actions-runner-system/swarm-runners-scaleset-7d4866c5-listener
actions-runner-system/swarm-runners-scaleset-hkss5-runner-lkjlp
calico-system/calico-node-2cvj7
calico-system/calico-node-jd4cl
calico-system/calico-node-pjgs8
calico-system/calico-node-zgvjv
calico-system/csi-node-driver-8hf6g
calico-system/csi-node-driver-8hf6g
calico-system/csi-node-driver-dbm9t
calico-system/csi-node-driver-dbm9t
calico-system/csi-node-driver-kwltm
calico-system/csi-node-driver-kwltm
calico-system/csi-node-driver-q6fsx
calico-system/csi-node-driver-q6fsx
elk/elasticsearch-0
elk/kibana-6d8d8d9d96-6bbwn
elk/mongodb-sync-29526285-vk9b4
elk/mongodb-sync-29529840-b2mvk
elk/mongodb-sync-29530590-d8c6b
```
*(List truncated to first 20)*

## 3. HostPath Volume Usage
Pods mounting host filesystem paths:
```
calico-system/calico-node-2cvj7
calico-system/calico-node-jd4cl
calico-system/calico-node-pjgs8
calico-system/calico-node-zgvjv
calico-system/csi-node-driver-8hf6g
calico-system/csi-node-driver-dbm9t
calico-system/csi-node-driver-kwltm
calico-system/csi-node-driver-q6fsx
kube-system/etcd-k8-manager
kube-system/kube-apiserver-k8-manager
kube-system/kube-controller-manager-k8-manager
kube-system/kube-proxy-kblfg
kube-system/kube-proxy-p9gdf
kube-system/kube-proxy-t4sv5
kube-system/kube-proxy-zwsjt
kube-system/kube-scheduler-k8-manager
tigera-operator/tigera-operator-7b9dcd4cd7-k6bx2
trivy-system/node-collector-9b759b4d8-lh6l4
zabbix/zabbix-agent-6fftl
zabbix/zabbix-agent-ksjkb
zabbix/zabbix-agent-ksx2w
zabbix/zabbix-agent-qz6g2
```

## 4. Usage of ':latest' Image Tag
Deployments using mutable ':latest' tag:
```
ghcr.io/actions/actions-runner:latest
n8nio/n8n:latest
zabbix/zabbix-agent2:latest
zabbix/zabbix-server-pgsql:latest
zabbix/zabbix-web-nginx-pgsql:latest
```

# Parte 2: Auditoría RBAC y Redes

## 5. ServiceAccounts con 'cluster-admin'
Cuentas de servicio con control total del clúster (Potencial riesgo alto):
```
kubernetes-dashboard/admin-user
portainer/portainer-sa-clusteradmin
```

## 6. Roles con Permisos Wildcard (*)
Roles/ClusterRoles que otorgan acceso a '*' recursos o verbos:
```
ClusterRole: cluster-admin

```

## 7. Namespaces sin NetworkPolicies
Namespaces donde el tráfico está abierto por defecto (Sin aislamiento):
```
actions-runner-system (0 Policies)
calico-system (0 Policies)
default (0 Policies)
elk (0 Policies)
ingress-nginx (0 Policies)
itop (0 Policies)
kube-node-lease (0 Policies)
kube-public (0 Policies)
kube-system (0 Policies)
kubernetes-dashboard (0 Policies)
local-path-storage (0 Policies)
metallb-system (0 Policies)
mongo (0 Policies)
n8n (0 Policies)
tigera-operator (0 Policies)
trivy-system (0 Policies)
zabbix (0 Policies)
```

# Parte 3: Escaneo de Vulnerabilidades y Compliance (Trivy)

## 8. Resumen de Vulnerabilidades (Cluster)
Escaneo de vulnerabilidades críticas y altas en el clúster:
```
```

## 9. Top 10 Vulnerabilidades Críticas
Detalle de las vulnerabilidades más críticas encontradas:
```
[
  {
    "Name": "calico-node",
    "Namespace": "calico-system",
    "Count": 192
  },
  {
    "Name": "mongo",
    "Namespace": "mongo",
    "Count": 81
  },
  {
    "Name": "swarm-runners-scaleset-hkss5-runner-p879j",
    "Namespace": "actions-runner-system",
    "Count": 64
  },
  {
    "Name": "swarm-runners-scaleset-hkss5-runner-lkjlp",
    "Namespace": "actions-runner-system",
    "Count": 64
  },
  {
    "Name": "swarm-runners-scaleset-hkss5-runner-frbxn",
    "Namespace": "actions-runner-system",
    "Count": 64
  },
  {
    "Name": "scan-vulnerabilityreport-85f5c7c74",
    "Namespace": "trivy-system",
    "Count": 64
  },
  {
    "Name": "scan-vulnerabilityreport-75fdcff7d5",
    "Namespace": "trivy-system",
    "Count": 48
  },
  {
    "Name": "ingress-nginx-controller",
    "Namespace": "ingress-nginx",
    "Count": 36
  },
  {
    "Name": "scan-vulnerabilityreport-f55ddf94f",
    "Namespace": "trivy-system",
    "Count": 32
  },
  {
    "Name": "scan-vulnerabilityreport-9b8b97657",
    "Namespace": "trivy-system",
    "Count": 32
  }
]
```

## 10. Security Compliance Score

### Global Score: **52%**

| Category | Total Audited | Violations | Compliance |
|---|---|---|---|
| Pod Security (Privileged) | 55 | 16 | 70% |
| Pod Security (Root User) | 55 | 52 | 5% |
| Pod Security (HostPath) | 55 | 22 | 60% |
| Best Practices (Tags) | 55 | 5 | 90% |
| Network Policies | 18 | 17 | 5% |

## 11. Detailed Violations Log
Full list of resources violating security best practices:


### 1. Privileged Containers
- calico-system/calico-node-2cvj7
- calico-system/calico-node-jd4cl
- calico-system/calico-node-pjgs8
- calico-system/calico-node-zgvjv
- calico-system/csi-node-driver-8hf6g
- calico-system/csi-node-driver-8hf6g
- calico-system/csi-node-driver-dbm9t
- calico-system/csi-node-driver-dbm9t
- calico-system/csi-node-driver-kwltm
- calico-system/csi-node-driver-kwltm
- calico-system/csi-node-driver-q6fsx
- calico-system/csi-node-driver-q6fsx
- kube-system/kube-proxy-kblfg
- kube-system/kube-proxy-p9gdf
- kube-system/kube-proxy-t4sv5
- kube-system/kube-proxy-zwsjt

### 2. Containers Running as Root
- actions-runner-system/gha-rs-controller-cd9ccc9c5-2bn9d
- actions-runner-system/swarm-runners-scaleset-7d4866c5-listener
- actions-runner-system/swarm-runners-scaleset-hkss5-runner-lkjlp
- calico-system/calico-node-2cvj7
- calico-system/calico-node-jd4cl
- calico-system/calico-node-pjgs8
- calico-system/calico-node-zgvjv
- calico-system/csi-node-driver-8hf6g
- calico-system/csi-node-driver-8hf6g
- calico-system/csi-node-driver-dbm9t
- calico-system/csi-node-driver-dbm9t
- calico-system/csi-node-driver-kwltm
- calico-system/csi-node-driver-kwltm
- calico-system/csi-node-driver-q6fsx
- calico-system/csi-node-driver-q6fsx
- elk/elasticsearch-0
- elk/kibana-6d8d8d9d96-6bbwn
- elk/mongodb-sync-29526285-vk9b4
- elk/mongodb-sync-29529840-b2mvk
- elk/mongodb-sync-29530590-d8c6b
- elk/mongodb-sync-29530605-bdshh
- itop/itop-655d9f67f8-8dds7
- itop/mysql-6d89499c7c-bwdcl
- kube-system/coredns-668d6bf9bc-blvkl
- kube-system/coredns-668d6bf9bc-l86hn
- kube-system/etcd-k8-manager
- kube-system/kube-apiserver-k8-manager
- kube-system/kube-controller-manager-k8-manager
- kube-system/kube-proxy-kblfg
- kube-system/kube-proxy-p9gdf
- kube-system/kube-proxy-t4sv5
- kube-system/kube-proxy-zwsjt
- kube-system/kube-scheduler-k8-manager
- kubernetes-dashboard/dashboard-metrics-scraper-5bd45c9dd6-6kp8q
- kubernetes-dashboard/kubernetes-dashboard-84fb97c47f-cvdxr
- local-path-storage/local-path-provisioner-6bc759bc5-5xb67
- metallb-system/speaker-fzckw
- metallb-system/speaker-jtkrt
- metallb-system/speaker-qlr7k
- metallb-system/speaker-xfb9s
- mongo/mongo-0
- n8n/n8n-6f66788f78-cbgjf
- tigera-operator/tigera-operator-7b9dcd4cd7-k6bx2
- trivy-system/node-collector-9b759b4d8-lh6l4
- trivy-system/trivy-operator-5cbf845bf9-28n7j
- zabbix/postgresql-7dfd4b4b68-kdbz9
- zabbix/zabbix-agent-6fftl
- zabbix/zabbix-agent-ksjkb
- zabbix/zabbix-agent-ksx2w
- zabbix/zabbix-agent-qz6g2
- zabbix/zabbix-server-554759d44b-mf4q5
- zabbix/zabbix-web-677b9f7b9c-sljl8

### 3. HostPath Volume Usage
- calico-system/calico-node-2cvj7
- calico-system/calico-node-jd4cl
- calico-system/calico-node-pjgs8
- calico-system/calico-node-zgvjv
- calico-system/csi-node-driver-8hf6g
- calico-system/csi-node-driver-dbm9t
- calico-system/csi-node-driver-kwltm
- calico-system/csi-node-driver-q6fsx
- kube-system/etcd-k8-manager
- kube-system/kube-apiserver-k8-manager
- kube-system/kube-controller-manager-k8-manager
- kube-system/kube-proxy-kblfg
- kube-system/kube-proxy-p9gdf
- kube-system/kube-proxy-t4sv5
- kube-system/kube-proxy-zwsjt
- kube-system/kube-scheduler-k8-manager
- tigera-operator/tigera-operator-7b9dcd4cd7-k6bx2
- trivy-system/node-collector-9b759b4d8-lh6l4
- zabbix/zabbix-agent-6fftl
- zabbix/zabbix-agent-ksjkb
- zabbix/zabbix-agent-ksx2w
- zabbix/zabbix-agent-qz6g2

### 4. Usage of ':latest' Image Tag
- ghcr.io/actions/actions-runner:latest
- n8nio/n8n:latest
- zabbix/zabbix-agent2:latest
- zabbix/zabbix-server-pgsql:latest
- zabbix/zabbix-web-nginx-pgsql:latest

### 5. ServiceAccounts with cluster-admin
- kubernetes-dashboard/admin-user
- portainer/portainer-sa-clusteradmin

### 6. Roles with Wildcard Permissions
- ClusterRole: cluster-admin
- 

### 7. Namespaces without NetworkPolicies
- actions-runner-system (0 Policies)
- calico-system (0 Policies)
- default (0 Policies)
- elk (0 Policies)
- ingress-nginx (0 Policies)
- itop (0 Policies)
- kube-node-lease (0 Policies)
- kube-public (0 Policies)
- kube-system (0 Policies)
- kubernetes-dashboard (0 Policies)
- local-path-storage (0 Policies)
- metallb-system (0 Policies)
- mongo (0 Policies)
- n8n (0 Policies)
- tigera-operator (0 Policies)
- trivy-system (0 Policies)
- zabbix (0 Policies)
- 

