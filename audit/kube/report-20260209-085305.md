# Kubernetes Security Audit Report
Date: Mon Feb  9 08:53:05 UTC 2026

## 1. Privileged Containers
Pods running with 'privileged: true' (Full host access):
```
calico-system/calico-node-2cvj7
calico-system/calico-node-jd4cl
calico-system/calico-node-pjgs8
calico-system/calico-node-zgvjv
calico-system/csi-node-driver-8hf6g
calico-system/csi-node-driver-8hf6g
calico-system/csi-node-driver-dbm9t
calico-system/csi-node-driver-dbm9t
calico-system/csi-node-driver-kwltm
calico-system/csi-node-driver-kwltm
calico-system/csi-node-driver-q6fsx
calico-system/csi-node-driver-q6fsx
kube-system/kube-proxy-kblfg
kube-system/kube-proxy-p9gdf
kube-system/kube-proxy-t4sv5
kube-system/kube-proxy-zwsjt
```

## 2. Containers Running as Root
Pods not enforcing 'runAsNonRoot: true':
```
actions-runner-system/gha-rs-controller-cd9ccc9c5-2bn9d
actions-runner-system/swarm-runners-scaleset-7d4866c5-listener
actions-runner-system/swarm-runners-scaleset-hkss5-runner-6gzwg
actions-runner-system/swarm-runners-scaleset-hkss5-runner-jpzc6
calico-system/calico-node-2cvj7
calico-system/calico-node-jd4cl
calico-system/calico-node-pjgs8
calico-system/calico-node-zgvjv
calico-system/csi-node-driver-8hf6g
calico-system/csi-node-driver-8hf6g
calico-system/csi-node-driver-dbm9t
calico-system/csi-node-driver-dbm9t
calico-system/csi-node-driver-kwltm
calico-system/csi-node-driver-kwltm
calico-system/csi-node-driver-q6fsx
calico-system/csi-node-driver-q6fsx
elk/elasticsearch-0
elk/kibana-6d8d8d9d96-jvww7
elk/sync-test-dzhbc
elk/sync-test-jp4k6
```
*(List truncated to first 20)*

## 3. HostPath Volume Usage
Pods mounting host filesystem paths:
```
calico-system/calico-node-2cvj7
calico-system/calico-node-jd4cl
calico-system/calico-node-pjgs8
calico-system/calico-node-zgvjv
calico-system/csi-node-driver-8hf6g
calico-system/csi-node-driver-dbm9t
calico-system/csi-node-driver-kwltm
calico-system/csi-node-driver-q6fsx
kube-system/etcd-k8-manager
kube-system/kube-apiserver-k8-manager
kube-system/kube-controller-manager-k8-manager
kube-system/kube-proxy-kblfg
kube-system/kube-proxy-p9gdf
kube-system/kube-proxy-t4sv5
kube-system/kube-proxy-zwsjt
kube-system/kube-scheduler-k8-manager
tigera-operator/tigera-operator-7b9dcd4cd7-k6bx2
trivy-system/node-collector-9b759b4d8-lh6l4
zabbix/zabbix-agent-6fftl
zabbix/zabbix-agent-ksjkb
zabbix/zabbix-agent-ksx2w
zabbix/zabbix-agent-qz6g2
```

## 4. Usage of ':latest' Image Tag
Deployments using mutable ':latest' tag:
```
ghcr.io/actions/actions-runner:latest
ghcr.io/plankanban/planka:latest
zabbix/zabbix-agent2:latest
zabbix/zabbix-server-pgsql:latest
zabbix/zabbix-web-nginx-pgsql:latest
```

# Parte 2: Auditoría RBAC y Redes

## 5. ServiceAccounts con 'cluster-admin'
Cuentas de servicio con control total del clúster (Potencial riesgo alto):
```
kubernetes-dashboard/admin-user
portainer/portainer-sa-clusteradmin
```

## 6. Roles con Permisos Wildcard (*)
Roles/ClusterRoles que otorgan acceso a '*' recursos o verbos:
```
ClusterRole: cluster-admin

```

## 7. Namespaces sin NetworkPolicies
Namespaces donde el tráfico está abierto por defecto (Sin aislamiento):
```
actions-runner-system (0 Policies)
calico-system (0 Policies)
default (0 Policies)
elk (0 Policies)
ingress-nginx (0 Policies)
itop (0 Policies)
kube-node-lease (0 Policies)
kube-public (0 Policies)
kube-system (0 Policies)
kubernetes-dashboard (0 Policies)
local-path-storage (0 Policies)
metallb-system (0 Policies)
mongo (0 Policies)
planka (0 Policies)
tigera-operator (0 Policies)
trivy-system (0 Policies)
zabbix (0 Policies)
```

# Parte 3: Escaneo de Vulnerabilidades y Compliance (Trivy)

## 8. Resumen de Vulnerabilidades (Cluster)
Escaneo de vulnerabilidades críticas y altas en el clúster:
```
```

## 9. Top 10 Vulnerabilidades Críticas
Detalle de las vulnerabilidades más críticas encontradas:
```
[
  {
    "Name": "calico-node",
    "Namespace": "calico-system",
    "Count": 106
  },
  {
    "Name": "scan-vulnerabilityreport-85f5c7c74",
    "Namespace": "trivy-system",
    "Count": 56
  },
  {
    "Name": "scan-vulnerabilityreport-75fdcff7d5",
    "Namespace": "trivy-system",
    "Count": 42
  },
  {
    "Name": "scan-vulnerabilityreport-f55ddf94f",
    "Namespace": "trivy-system",
    "Count": 28
  },
  {
    "Name": "scan-vulnerabilityreport-9b8b97657",
    "Namespace": "trivy-system",
    "Count": 28
  },
  {
    "Name": "scan-vulnerabilityreport-86b66dfd6f",
    "Namespace": "trivy-system",
    "Count": 28
  },
  {
    "Name": "scan-vulnerabilityreport-8678cd695d",
    "Namespace": "trivy-system",
    "Count": 28
  },
  {
    "Name": "scan-vulnerabilityreport-7b46d5f745",
    "Namespace": "trivy-system",
    "Count": 28
  },
  {
    "Name": "scan-vulnerabilityreport-756595f7cd",
    "Namespace": "trivy-system",
    "Count": 28
  },
  {
    "Name": "scan-vulnerabilityreport-74ff4778ff",
    "Namespace": "trivy-system",
    "Count": 28
  }
]
```

## 10. Security Compliance Score

### Global Score: **55%**

| Category | Total Audited | Violations | Compliance |
|---|---|---|---|
| Pod Security (Privileged) | 63 | 16 | 74% |
| Pod Security (Root User) | 63 | 59 | 6% |
| Pod Security (HostPath) | 63 | 22 | 65% |
| Best Practices (Tags) | 63 | 5 | 92% |
| Network Policies | 18 | 17 | 5% |

## 11. Detailed Violations Log
Full list of resources violating security best practices:


### 1. Privileged Containers
- calico-system/calico-node-2cvj7
- calico-system/calico-node-jd4cl
- calico-system/calico-node-pjgs8
- calico-system/calico-node-zgvjv
- calico-system/csi-node-driver-8hf6g
- calico-system/csi-node-driver-8hf6g
- calico-system/csi-node-driver-dbm9t
- calico-system/csi-node-driver-dbm9t
- calico-system/csi-node-driver-kwltm
- calico-system/csi-node-driver-kwltm
- calico-system/csi-node-driver-q6fsx
- calico-system/csi-node-driver-q6fsx
- kube-system/kube-proxy-kblfg
- kube-system/kube-proxy-p9gdf
- kube-system/kube-proxy-t4sv5
- kube-system/kube-proxy-zwsjt

### 2. Containers Running as Root
- actions-runner-system/gha-rs-controller-cd9ccc9c5-2bn9d
- actions-runner-system/swarm-runners-scaleset-7d4866c5-listener
- actions-runner-system/swarm-runners-scaleset-hkss5-runner-6gzwg
- actions-runner-system/swarm-runners-scaleset-hkss5-runner-jpzc6
- calico-system/calico-node-2cvj7
- calico-system/calico-node-jd4cl
- calico-system/calico-node-pjgs8
- calico-system/calico-node-zgvjv
- calico-system/csi-node-driver-8hf6g
- calico-system/csi-node-driver-8hf6g
- calico-system/csi-node-driver-dbm9t
- calico-system/csi-node-driver-dbm9t
- calico-system/csi-node-driver-kwltm
- calico-system/csi-node-driver-kwltm
- calico-system/csi-node-driver-q6fsx
- calico-system/csi-node-driver-q6fsx
- elk/elasticsearch-0
- elk/kibana-6d8d8d9d96-jvww7
- elk/sync-test-dzhbc
- elk/sync-test-jp4k6
- itop/itop-64676894dc-f7fr9
- itop/mysql-6c885b98c4-lhd4q
- kube-system/coredns-668d6bf9bc-blvkl
- kube-system/coredns-668d6bf9bc-l86hn
- kube-system/etcd-k8-manager
- kube-system/kube-apiserver-k8-manager
- kube-system/kube-controller-manager-k8-manager
- kube-system/kube-proxy-kblfg
- kube-system/kube-proxy-p9gdf
- kube-system/kube-proxy-t4sv5
- kube-system/kube-proxy-zwsjt
- kube-system/kube-scheduler-k8-manager
- kubernetes-dashboard/dashboard-metrics-scraper-5bd45c9dd6-nks5r
- kubernetes-dashboard/kubernetes-dashboard-79cbcf9fb6-bm75t
- local-path-storage/local-path-provisioner-6bc759bc5-tfcgj
- metallb-system/speaker-fzckw
- metallb-system/speaker-jtkrt
- metallb-system/speaker-qlr7k
- metallb-system/speaker-xfb9s
- mongo/mongo-0
- planka/planka-db-6f8857ffc9-rkd5t
- planka/planka-fc7bbcf8b-rm5bp
- tigera-operator/tigera-operator-7b9dcd4cd7-k6bx2
- trivy-system/node-collector-9b759b4d8-lh6l4
- trivy-system/scan-vulnerabilityreport-56bff54df6-4flwj
- trivy-system/scan-vulnerabilityreport-74b9cf67dd-ms9rc
- trivy-system/scan-vulnerabilityreport-756595f7cd-nghjj
- trivy-system/scan-vulnerabilityreport-85f5c7c74-l8mp4
- trivy-system/scan-vulnerabilityreport-85f5c7c74-l8mp4
- trivy-system/scan-vulnerabilityreport-85f5c7c74-l8mp4
- trivy-system/scan-vulnerabilityreport-8678cd695d-9d6pk
- trivy-system/trivy-operator-5cbf845bf9-fbrtt
- zabbix/postgresql-7dfd4b4b68-kdbz9
- zabbix/zabbix-agent-6fftl
- zabbix/zabbix-agent-ksjkb
- zabbix/zabbix-agent-ksx2w
- zabbix/zabbix-agent-qz6g2
- zabbix/zabbix-server-554759d44b-mf4q5
- zabbix/zabbix-web-677b9f7b9c-sljl8

### 3. HostPath Volume Usage
- calico-system/calico-node-2cvj7
- calico-system/calico-node-jd4cl
- calico-system/calico-node-pjgs8
- calico-system/calico-node-zgvjv
- calico-system/csi-node-driver-8hf6g
- calico-system/csi-node-driver-dbm9t
- calico-system/csi-node-driver-kwltm
- calico-system/csi-node-driver-q6fsx
- kube-system/etcd-k8-manager
- kube-system/kube-apiserver-k8-manager
- kube-system/kube-controller-manager-k8-manager
- kube-system/kube-proxy-kblfg
- kube-system/kube-proxy-p9gdf
- kube-system/kube-proxy-t4sv5
- kube-system/kube-proxy-zwsjt
- kube-system/kube-scheduler-k8-manager
- tigera-operator/tigera-operator-7b9dcd4cd7-k6bx2
- trivy-system/node-collector-9b759b4d8-lh6l4
- zabbix/zabbix-agent-6fftl
- zabbix/zabbix-agent-ksjkb
- zabbix/zabbix-agent-ksx2w
- zabbix/zabbix-agent-qz6g2

### 4. Usage of ':latest' Image Tag
- ghcr.io/actions/actions-runner:latest
- ghcr.io/plankanban/planka:latest
- zabbix/zabbix-agent2:latest
- zabbix/zabbix-server-pgsql:latest
- zabbix/zabbix-web-nginx-pgsql:latest

### 5. ServiceAccounts with cluster-admin
- kubernetes-dashboard/admin-user
- portainer/portainer-sa-clusteradmin

### 6. Roles with Wildcard Permissions
- ClusterRole: cluster-admin
- 

### 7. Namespaces without NetworkPolicies
- actions-runner-system (0 Policies)
- calico-system (0 Policies)
- default (0 Policies)
- elk (0 Policies)
- ingress-nginx (0 Policies)
- itop (0 Policies)
- kube-node-lease (0 Policies)
- kube-public (0 Policies)
- kube-system (0 Policies)
- kubernetes-dashboard (0 Policies)
- local-path-storage (0 Policies)
- metallb-system (0 Policies)
- mongo (0 Policies)
- planka (0 Policies)
- tigera-operator (0 Policies)
- trivy-system (0 Policies)
- zabbix (0 Policies)
- 

