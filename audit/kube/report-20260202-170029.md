# Kubernetes Security Audit Report
Date: Mon Feb  2 17:00:29 UTC 2026

## 1. Privileged Containers
Pods running with 'privileged: true' (Full host access):
```
calico-system/calico-node-g7m88
calico-system/calico-node-hnmlv
calico-system/calico-node-jvntn
calico-system/calico-node-rf4ft
calico-system/csi-node-driver-8hf6g
calico-system/csi-node-driver-8hf6g
calico-system/csi-node-driver-98lz5
calico-system/csi-node-driver-98lz5
calico-system/csi-node-driver-dbm9t
calico-system/csi-node-driver-dbm9t
calico-system/csi-node-driver-kwltm
calico-system/csi-node-driver-kwltm
kube-system/kube-proxy-p7f6l
kube-system/kube-proxy-p9gdf
kube-system/kube-proxy-t4sv5
kube-system/kube-proxy-zwsjt
```

## 2. Containers Running as Root
Pods not enforcing 'runAsNonRoot: true':
```
actions-runner-system/gha-rs-controller-58c7f58794-mst7s
actions-runner-system/swarm-runners-scaleset-7d4866c5-listener
actions-runner-system/swarm-runners-scaleset-hkss5-runner-fgp2l
calico-system/calico-node-g7m88
calico-system/calico-node-hnmlv
calico-system/calico-node-jvntn
calico-system/calico-node-rf4ft
calico-system/csi-node-driver-8hf6g
calico-system/csi-node-driver-8hf6g
calico-system/csi-node-driver-98lz5
calico-system/csi-node-driver-98lz5
calico-system/csi-node-driver-dbm9t
calico-system/csi-node-driver-dbm9t
calico-system/csi-node-driver-kwltm
calico-system/csi-node-driver-kwltm
elastic/elasticsearch-5d45d4955-7kczd
elastic/kibana-b44746c44-qkqnj
elastic/logstash-587448f45b-9h92b
itop/itop-7d6497fb9b-5qpnn
itop/itop-7d6497fb9b-5qpnn
```
*(List truncated to first 20)*

## 3. HostPath Volume Usage
Pods mounting host filesystem paths:
```
calico-system/calico-node-g7m88
calico-system/calico-node-hnmlv
calico-system/calico-node-jvntn
calico-system/calico-node-rf4ft
calico-system/csi-node-driver-8hf6g
calico-system/csi-node-driver-98lz5
calico-system/csi-node-driver-dbm9t
calico-system/csi-node-driver-kwltm
kube-system/etcd-k8-manager
kube-system/kube-apiserver-k8-manager
kube-system/kube-controller-manager-k8-manager
kube-system/kube-proxy-p7f6l
kube-system/kube-proxy-p9gdf
kube-system/kube-proxy-t4sv5
kube-system/kube-proxy-zwsjt
kube-system/kube-scheduler-k8-manager
monitoring/cadvisor-57l46
monitoring/cadvisor-jws26
monitoring/cadvisor-m8ggh
monitoring/cadvisor-szbzt
monitoring/node-exporter-4j2n7
monitoring/node-exporter-cnch2
monitoring/node-exporter-fk6wz
monitoring/node-exporter-zs9ll
monitoring/promtail-62s7t
monitoring/promtail-64vgx
monitoring/promtail-qml9t
monitoring/promtail-wcxsz
tigera-operator/tigera-operator-7b9dcd4cd7-k6bx2
zabbix/zabbix-agent-6fftl
zabbix/zabbix-agent-76t7c
zabbix/zabbix-agent-ksjkb
zabbix/zabbix-agent-ksx2w
```

## 4. Usage of ':latest' Image Tag
Deployments using mutable ':latest' tag:
```
gcr.io/cadvisor/cadvisor:latest
ghcr.io/actions/actions-runner:latest
ghcr.io/plankanban/planka:latest
grafana/grafana:latest
grafana/loki:latest
grafana/promtail:latest
n8nio/n8n:latest
prom/node-exporter:latest
prom/prometheus:latest
zabbix/zabbix-agent2:latest
zabbix/zabbix-server-pgsql:latest
zabbix/zabbix-web-nginx-pgsql:latest
```

# Parte 2: Auditoría RBAC y Redes

## 5. ServiceAccounts con 'cluster-admin'
Cuentas de servicio con control total del clúster (Potencial riesgo alto):
```
portainer/portainer-sa-clusteradmin
```

## 6. Roles con Permisos Wildcard (*)
Roles/ClusterRoles que otorgan acceso a '*' recursos o verbos:
```
ClusterRole: cluster-admin

```

## 7. Namespaces sin NetworkPolicies
Namespaces donde el tráfico está abierto por defecto (Sin aislamiento):
```
actions-runner-system (0 Policies)
calico-system (0 Policies)
default (0 Policies)
elastic (0 Policies)
itop (0 Policies)
kube-node-lease (0 Policies)
kube-public (0 Policies)
kube-system (0 Policies)
kubernetes-dashboard (0 Policies)
local-path-storage (0 Policies)
metallb-system (0 Policies)
mongo (0 Policies)
monitoring (0 Policies)
n8n (0 Policies)
planka (0 Policies)
tigera-operator (0 Policies)
zabbix (0 Policies)
```

# Parte 3: Escaneo de Vulnerabilidades y Compliance (Trivy)

## 8. Resumen de Vulnerabilidades (Cluster)
Escaneo de vulnerabilidades críticas y altas en el clúster:
```

Summary Report for cluster
==========================

Workload Assessment
┌───────────────────────┬───────────────────────────────────────────────┬─────────────────┬───────────────────┬─────────┐
│       Namespace       │                   Resource                    │ Vulnerabilities │ Misconfigurations │ Secrets │
│                       │                                               ├────────┬────────┼─────────┬─────────┼────┬────┤
│                       │                                               │   C    │   H    │    C    │    H    │ C  │ H  │
├───────────────────────┼───────────────────────────────────────────────┼────────┼────────┼─────────┼─────────┼────┼────┤
│ zabbix                │ DaemonSet/zabbix-agent                        │        │        │         │ 6       │    │    │
│ zabbix                │ Deployment/zabbix-web                         │   1    │        │         │ 3       │    │    │
│ zabbix                │ ConfigMap/zabbix-external-scripts             │        │        │         │ 1       │    │    │
│ zabbix                │ ConfigMap/zabbix-scripts                      │        │        │         │ 1       │    │    │
│ zabbix                │ Deployment/postgresql                         │   3    │   19   │         │ 3       │    │ 1  │
│ zabbix                │ Deployment/zabbix-server                      │        │        │         │ 3       │    │    │
│ tigera-operator       │ Deployment/tigera-operator                    │   2    │   8    │         │ 4       │    │    │
│ planka                │ Deployment/planka                             │   2    │   18   │         │ 7       │    │    │
│ planka                │ Deployment/planka-db                          │        │   4    │         │ 3       │    │    │
│ n8n                   │ Deployment/postgres                           │   3    │   26   │         │ 3       │    │ 1  │
│ n8n                   │ Deployment/n8n                                │   3    │   8    │         │ 5       │    │    │
│ monitoring            │ DaemonSet/cadvisor                            │   2    │   4    │         │ 4       │    │    │
│ monitoring            │ Deployment/grafana                            │   2    │   2    │         │ 3       │    │    │
│ monitoring            │ DaemonSet/node-exporter                       │        │   4    │         │ 7       │    │    │
│ monitoring            │ StatefulSet/loki                              │        │        │         │ 1       │    │    │
│ monitoring            │ Deployment/kube-state-metrics                 │   2    │   13   │         │ 1       │    │    │
│ monitoring            │ Deployment/prometheus-deployment              │        │   4    │         │ 3       │    │    │
│ monitoring            │ DaemonSet/promtail                            │        │        │         │ 3       │    │    │
│ mongo                 │ StatefulSet/mongo                             │        │   52   │         │ 3       │    │    │
│ metallb-system        │ Deployment/controller                         │   3    │   55   │         │         │    │    │
│ metallb-system        │ DaemonSet/speaker                             │   7    │   96   │         │ 3       │    │    │
│ local-path-storage    │ Deployment/local-path-provisioner             │   2    │   7    │         │ 3       │    │    │
│ itop                  │ Deployment/mysql                              │   3    │   72   │         │ 3       │    │    │
│ itop                  │ Deployment/itop                               │        │   18   │         │ 8       │    │ 2  │
│ elastic               │ Deployment/logstash                           │   5    │   34   │         │ 4       │    │    │
│ elastic               │ Deployment/kibana                             │   2    │   24   │         │ 6       │    │    │
│ elastic               │ Deployment/elasticsearch                      │   3    │   13   │         │ 5       │    │    │
│ calico-system         │ Deployment/calico-typha                       │   2    │   8    │         │ 3       │    │    │
│ calico-system         │ Deployment/calico-kube-controllers            │   3    │   14   │         │ 2       │    │    │
│ calico-system         │ DaemonSet/calico-node                         │   15   │   88   │         │ 8       │    │    │
│ calico-system         │ DaemonSet/csi-node-driver                     │   2    │   12   │         │ 5       │    │    │
│ calico-apiserver      │ Deployment/calico-apiserver                   │   2    │   10   │         │ 2       │    │    │
│ actions-runner-system │ Pod/swarm-runners-scaleset-7d4866c5-listener  │        │   20   │         │ 3       │    │    │
│ actions-runner-system │ Pod/swarm-runners-scaleset-hkss5-runner-fgp2l │        │   36   │         │ 3       │    │    │
│ actions-runner-system │ Deployment/gha-rs-controller                  │        │   20   │         │ 3       │    │    │
└───────────────────────┴───────────────────────────────────────────────┴────────┴────────┴─────────┴─────────┴────┴────┘
Severities: C=CRITICAL H=HIGH


Infra Assessment
┌─────────────┬────────────────────────────────────────┬─────────────────┬───────────────────┬─────────┐
│  Namespace  │                Resource                │ Vulnerabilities │ Misconfigurations │ Secrets │
│             │                                        ├───────┬─────────┼─────────┬─────────┼────┬────┤
│             │                                        │   C   │   H     │    C    │    H    │ C  │ H  │
├─────────────┼────────────────────────────────────────┼───────┼─────────┼─────────┼─────────┼────┼────┤
│ kube-system │ DaemonSet/kube-proxy                   │   2   │   11    │         │ 4       │    │    │
│ kube-system │ Deployment/coredns                     │   1   │   10    │         │ 1       │    │    │
│ kube-system │ Deployment/metrics-server              │       │   5     │         │ 1       │    │    │
│ kube-system │ Pod/kube-apiserver-k8-manager          │   1   │   7     │         │ 2       │    │    │
│ kube-system │ Pod/etcd-k8-manager                    │       │   9     │         │ 2       │    │    │
│ kube-system │ Pod/kube-controller-manager-k8-manager │   1   │   10    │         │ 2       │    │    │
│ kube-system │ Pod/kube-scheduler-k8-manager          │   1   │   6     │         │ 2       │    │    │
│             │ Node/k8-node-20                        │       │         │         │ 2       │    │    │
│             │ Node/k8-node-30                        │       │         │         │ 2       │    │    │
│             │ Node/k8-manager                        │       │         │         │ 3       │    │    │
└─────────────┴────────────────────────────────────────┴───────┴─────────┴─────────┴─────────┴────┴────┘
Severities: C=CRITICAL H=HIGH

```

## 9. Top 10 Vulnerabilidades Críticas
Detalle de las vulnerabilidades más críticas encontradas:
```
[
  {
    "Name": "calico-node",
    "Namespace": "calico-system",
    "Count": 106
  },
  {
    "Name": "logstash",
    "Namespace": "elastic",
    "Count": 15
  },
  {
    "Name": "speaker",
    "Namespace": "metallb-system",
    "Count": 14
  },
  {
    "Name": "calico-kube-controllers",
    "Namespace": "calico-system",
    "Count": 6
  },
  {
    "Name": "kube-proxy",
    "Namespace": "kube-system",
    "Count": 4
  },
  {
    "Name": "postgresql",
    "Namespace": "zabbix",
    "Count": 3
  },
  {
    "Name": "postgres",
    "Namespace": "n8n",
    "Count": 3
  },
  {
    "Name": "n8n",
    "Namespace": "n8n",
    "Count": 3
  },
  {
    "Name": "mysql",
    "Namespace": "itop",
    "Count": 3
  },
  {
    "Name": "elasticsearch",
    "Namespace": "elastic",
    "Count": 3
  }
]
```

## 10. Security Compliance Score

### Global Score: **50%**

| Category | Total Audited | Violations | Compliance |
|---|---|---|---|
| Pod Security (Privileged) | 67 | 16 | 76% |
| Pod Security (Root User) | 67 | 65 | 2% |
| Pod Security (HostPath) | 67 | 33 | 50% |
| Best Practices (Tags) | 67 | 12 | 82% |
| Network Policies | 18 | 17 | 5% |

